{{/* Define configuration variables */}}
{{ $logos := site.Data.logos }}
{{ $logosPerRow := 8 }}
{{ $maxRows := 3 }}

{{ if $logos }}
<section class="container my-5 py-5 text-center">
  <div class="row">
    <div class="col-md-8 mx-auto">
      <h2 class="title-2">Trusted By The Most <span>Innovative</span> Teams</h2>
      <p>
        MemMachine provides the memory layer for agents built by world-class engineering teams at the forefront of the AI revolution.
      </p>
    </div>
  </div>

  <div id="logo-marquee-container" class="mt-5">
    {{/* Make a mutable copy of the logos to process in chunks */}}
    {{ $logosToProcess := $logos }}

    {{/* Calculate the number of rows needed */}}
    {{ $numRows := math.Min $maxRows (math.Ceil (div (float (len $logos)) $logosPerRow)) }}

    {{/* Loop to create each row */}}
    {{ range $i, $e := (seq (int $numRows)) }}
      {{/* Get the next chunk of logos for the current row */}}
      {{ $rowLogos := first $logosPerRow $logosToProcess }}

      {{ if $rowLogos }}
        <div class="logo-marquee{{ if modBool (sub $i 1) 2 }} reverse{{ end }}">
          <div class="logo-scroller">
            
            {{/* Duplicate the logos within the scroller for a seamless loop */}}
            {{ range seq 2 }}
              {{ range $rowLogos }}
                <div class="logo-scroller-item">
                  <img src="{{ .src }}" alt="{{ .name }}" />
                </div>
              {{ end }}
            {{ end }}

          </div>
        </div>
      {{ end }}
      
      {{/* Update the list to remove the logos we just used for the next iteration */}}
      {{ $logosToProcess = after $logosPerRow $logosToProcess }}
    {{ end }}
  </div>
</section>
{{ end }}